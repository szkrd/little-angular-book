<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>little angular book</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="../../normalize.css" />
    <link rel="stylesheet" href="../../hljs-theme.css" />
    <link rel="stylesheet" href="../../markdown.css" />
    <link rel="stylesheet" href="../../main.css?v=2.0.0" />
  </head>
  <body>
    <div class="menu">
      
      <div class="menu-item depth-1 ">
         
        <a href="../../index.html">Little angular book</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../00-setup/index.html">Setup</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../01-typescript/index.html">TypeScript</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../01-typescript/01-basic-types/index.html">Basic types</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../01-typescript/02-classes-interfaces/index.html">Classes and interfaces</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../01-typescript/03-functions/index.html">Functions</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../01-typescript/04-enums/index.html">Enums</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../01-typescript/05-advanced-types/index.html">Advanced types</a>
        
      </div>
      
      <div class="menu-item depth-3 selected">
        â–¹
        <a href="../../01-typescript/06-decorators/index.html">Decorators</a>
        
        <div class="menu-section depth-4">
          â—¦
          <a href="#1">
            A method decorator
          </a>
        </div>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../01-typescript/06-utility-types/index.html">Utility types</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../01-typescript/07-generics/index.html">Generics</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../02-components/index.html">Components</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../02-components/01-lifecycle-events/index.html">Lifecycle events</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../02-components/02-input-output/index.html">Input / Output</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../02-components/03-templates/index.html">Templates</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../02-components/03-templates/01-raw-html/index.html">Raw HTML</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../02-components/03-templates/02-data-flow/index.html">Data flow</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../02-components/03-templates/03-class-style/index.html">Class &amp; style helpers</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../02-components/03-templates/04-structural-directives/index.html">Structural directives</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../02-components/03-templates/05-content-projection/index.html">Content projection (slots)</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../02-components/03-templates/06-pipes/index.html">Pipes</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../02-components/04-styles/index.html">Styles</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../02-components/05-standalone-components/index.html">Standalone components</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../03-routing/index.html">Routing</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../03-routing/01-parameters/index.html">Route parameters</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../03-routing/02-query-parameters/index.html">Query parameters</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../04-dependency-injection/index.html">Dependency injection</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../04-dependency-injection/01-circumventing-di/index.html">Circumventing the DI system</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../04-dependency-injection/02-sharing-services/index.html">Sharing services</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../04-dependency-injection/03-providers/index.html">Providers</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../04-dependency-injection/03-providers/01-class-provider/index.html">Class provider</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../04-dependency-injection/03-providers/02-factory-provider/index.html">Factory provider</a>
        
      </div>
      
      <div class="menu-item depth-4 ">
        â–ª
        <a href="../../04-dependency-injection/03-providers/03-value-provider/index.html">Value provider</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../04-dependency-injection/04-di-tricks/index.html">DI tricks</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../05-services/index.html">Services</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../06-testing/index.html">Testing</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../06-testing/01-jasmine/index.html">Jasmine </a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../07-observables/index.html">Observables</a>
        
      </div>
      
      <div class="menu-item depth-3 ">
        â–¹
        <a href="../../07-observables/01-examples/index.html">Examples</a>
        
      </div>
      
      <div class="menu-item depth-2 ">
        â–¸
        <a href="../../08-problems/index.html">Problems</a>
        
      </div>
      
    </div>
    <div class="markdown-body"><h1 id="decorators">Decorators</h1>
<ul>
<li>Decorators are functions when placed in a decorator context will be called with special contextual parameters.</li>
<li>If you want to create decorators that accept parameters during &quot;decoration&quot;, use a factory.</li>
<li>Ecmascript <strong>stage 3</strong> decorators are supported since TS 5.0 (this is a breaking change over the old decorator handling).</li>
<li>The <strong>old</strong> (stage 2) decorator handling is (still) available with <code>experimentalDecorators</code>.</li>
</ul>
<p>ðŸš€ With the new decorator handling most of this section has been removed and I consider it to be an &quot;advanced&quot; topic;
feel free to check the <a href="https://devblogs.microsoft.com/typescript/announcing-typescript-5-0/#decorators">TS5 decorator announcement</a> for details (or TS docs, should Microsoft update it; as of this writing it still reflects the stage 2 description).</p>
<h2><a name="1">A method decorator</a></h2>
<p>We want to add a logger to method calls using decorators.</p>
<pre class="hljs"><code class="language-typescript"><span class="hljs-keyword">class</span> Person {
  name: <span class="hljs-built_in">string</span>;
  <span class="hljs-keyword">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {
    <span class="hljs-built_in">this</span>.name = name;
  }

  <span class="hljs-meta">@logMethod</span>
  greet() {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Hello, my name is <span class="hljs-subst">${<span class="hljs-built_in">this</span>.name}</span>.`</span>);
  }
}

<span class="hljs-keyword">const</span> ron = <span class="hljs-keyword">new</span> Person(<span class="hljs-string">&#x27;Ron&#x27;</span>);
ron.greet();
</code></pre>
<p>The decorator (simplified somewhat, addig proper type annotations is not trivial):</p>
<pre class="hljs"><code class="language-typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loggedMethod</span>(<span class="hljs-params">originalMethod: <span class="hljs-built_in">any</span>, _context: <span class="hljs-built_in">any</span></span>) </span>{
  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">replacementMethod</span>(<span class="hljs-params"><span class="hljs-built_in">this</span>: <span class="hljs-built_in">any</span>, ...args: <span class="hljs-built_in">any</span>[]</span>) </span>{
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;LOG: Entering method.&#x27;</span>);
    <span class="hljs-keyword">const</span> result = originalMethod.call(<span class="hljs-built_in">this</span>, ...args);
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">&#x27;LOG: Exiting method.&#x27;</span>);
    <span class="hljs-keyword">return</span> result;
  }

  <span class="hljs-keyword">return</span> replacementMethod;
}
</code></pre>
<p>An example <code>bound</code> decorator (for auto binding methods):</p>
<pre class="hljs"><code class="language-typescript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bound</span>(<span class="hljs-params">originalMethod: <span class="hljs-built_in">any</span>, context: ClassMethodDecoratorContext</span>) </span>{
  <span class="hljs-keyword">const</span> methodName = context.name;
  <span class="hljs-keyword">if</span> (context.private) <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">`Cannot decorate private properties (<span class="hljs-subst">${methodName <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>}</span>).`</span>);
  context.addInitializer(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    (<span class="hljs-built_in">this</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[methodName] = (<span class="hljs-built_in">this</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">any</span>)[methodName].bind(<span class="hljs-built_in">this</span>);
  });
}
</code></pre>
</div>
    <script src="../../main.js?v=2.0.0"></script>
  </body>
</html>
